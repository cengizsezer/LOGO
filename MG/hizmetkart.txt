USE [NETLINE_TIGER]
GO

/****** Object:  View [dbo].[AAMG_TÜM_HİZMET_KART]    Script Date: 2/22/2025 6:25:14 PM ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO



ALTER VIEW [dbo].[AAMG_TÜM_HİZMET_KART] AS

SELECT 

FIRMA='101_TEZ_MEDIKAL'

,SRV.CODE 'HIZMET KODU'
,SRV.DEFINITION_ 'HIZMET ADI'
,SRV.SPECODE 'ÖZEL KOD1'
,ISNULL((SELECT SPE.DEFINITION_ FROM LG_101_SPECODES SPE WITH (NOLOCK) WHERE SPE.SPECODE=SRV.SPECODE AND SPE.CODETYPE=1 AND SPE.SPECODETYPE=4),'') 'ÖZEL KOD1 ACIKLAMA'
,SRV.SPECODE2 'ÖZEL KOD2'
,SRV.SPECODE3 'ÖZEL KOD3'
,SRV.SPECODE4 'ÖZEL KOD4'
,SRV.SPECODE5 'ÖZEL KOD5'
,SRV.VAT 'KDV'
,ISNULL((SELECT 
        EMU.CODE 
		FROM LG_101_CRDACREF CR WITH (NOLOCK)
		INNER JOIN LG_101_EMUHACC EMU WITH (NOLOCK) ON EMU.LOGICALREF=CR.ACCOUNTREF
		WHERE CR.TRCODE=3 AND CR.TYP=1 AND CR.CARDREF=SRV.LOGICALREF
 ),'') 'MUHASEBE HESABI KODU'
 ,ISNULL((SELECT 
        EMU.DEFINITION_ 
		FROM LG_101_CRDACREF CR WITH (NOLOCK)
		INNER JOIN LG_101_EMUHACC EMU WITH (NOLOCK) ON EMU.LOGICALREF=CR.ACCOUNTREF
		WHERE CR.TRCODE=3 AND CR.TYP=1 AND CR.CARDREF=SRV.LOGICALREF
 ),'') 'MUHASEBE HESABI AÇIKLAMASI'


FROM LG_101_SRVCARD SRV WITH (NOLOCK)


--WHERE SRV.CARDTYPE=1 AND SRV.ACTIVE=0


UNION ALL

SELECT 



FIRMA='107_TEZMED_HOL'

,SRV.CODE 'HIZMET KODU'
,SRV.DEFINITION_ 'HIZMET ADI'
,SRV.SPECODE 'ÖZEL KOD1'
,ISNULL((SELECT SPE.DEFINITION_ FROM LG_107_SPECODES SPE WITH (NOLOCK) WHERE SPE.SPECODE=SRV.SPECODE AND SPE.CODETYPE=1 AND SPE.SPECODETYPE=4),'') 'ÖZEL KOD1 ACIKLAMA'
,SRV.SPECODE2 'ÖZEL KOD2'
,SRV.SPECODE3 'ÖZEL KOD3'
,SRV.SPECODE4 'ÖZEL KOD4'
,SRV.SPECODE5 'ÖZEL KOD5'
,SRV.VAT 'KDV'
,ISNULL((SELECT 
        EMU.CODE 
		FROM LG_107_CRDACREF CR WITH (NOLOCK)
		INNER JOIN LG_107_EMUHACC EMU WITH (NOLOCK) ON EMU.LOGICALREF=CR.ACCOUNTREF
		WHERE CR.TRCODE=3 AND CR.TYP=1 AND CR.CARDREF=SRV.LOGICALREF
 ),'') 'MUHASEBE HESABI KODU'
 ,ISNULL((SELECT 
        EMU.DEFINITION_ 
		FROM LG_107_CRDACREF CR WITH (NOLOCK)
		INNER JOIN LG_107_EMUHACC EMU WITH (NOLOCK) ON EMU.LOGICALREF=CR.ACCOUNTREF
		WHERE CR.TRCODE=3 AND CR.TYP=1 AND CR.CARDREF=SRV.LOGICALREF
 ),'') 'MUHASEBE HESABI AÇIKLAMASI'


FROM LG_107_SRVCARD SRV WITH (NOLOCK)


--WHERE SRV.CARDTYPE=1 AND SRV.ACTIVE=0


UNION ALL

SELECT 

FIRMA='108_TEZ_INOV'

,SRV.CODE 'HIZMET KODU'
,SRV.DEFINITION_ 'HIZMET ADI'
,SRV.SPECODE 'ÖZEL KOD1'
,ISNULL((SELECT SPE.DEFINITION_ FROM LG_108_SPECODES SPE WITH (NOLOCK) WHERE SPE.SPECODE=SRV.SPECODE AND SPE.CODETYPE=1 AND SPE.SPECODETYPE=4),'') 'ÖZEL KOD1 ACIKLAMA'
,SRV.SPECODE2 'ÖZEL KOD2'
,SRV.SPECODE3 'ÖZEL KOD3'
,SRV.SPECODE4 'ÖZEL KOD4'
,SRV.SPECODE5 'ÖZEL KOD5'
,SRV.VAT 'KDV'
,ISNULL((SELECT 
        EMU.CODE 
		FROM LG_108_CRDACREF CR WITH (NOLOCK)
		INNER JOIN LG_108_EMUHACC EMU WITH (NOLOCK) ON EMU.LOGICALREF=CR.ACCOUNTREF
		WHERE CR.TRCODE=3 AND CR.TYP=1 AND CR.CARDREF=SRV.LOGICALREF
 ),'') 'MUHASEBE HESABI KODU'
 ,ISNULL((SELECT 
        EMU.DEFINITION_ 
		FROM LG_108_CRDACREF CR WITH (NOLOCK)
		INNER JOIN LG_108_EMUHACC EMU WITH (NOLOCK) ON EMU.LOGICALREF=CR.ACCOUNTREF
		WHERE CR.TRCODE=3 AND CR.TYP=1 AND CR.CARDREF=SRV.LOGICALREF
 ),'') 'MUHASEBE HESABI AÇIKLAMASI'


FROM LG_108_SRVCARD SRV WITH (NOLOCK)


--WHERE SRV.CARDTYPE=1 AND SRV.ACTIVE=0

UNION ALL
SELECT 

FIRMA='105_TEZ_FILO' 
     

,SRV.CODE 'HIZMET KODU'
,SRV.DEFINITION_ 'HIZMET ADI'
,SRV.SPECODE 'ÖZEL KOD1'
,ISNULL((SELECT SPE.DEFINITION_ FROM LG_105_SPECODES SPE WITH (NOLOCK) WHERE SPE.SPECODE=SRV.SPECODE AND SPE.CODETYPE=1 AND SPE.SPECODETYPE=4),'') 'ÖZEL KOD1 ACIKLAMA'
,SRV.SPECODE2 'ÖZEL KOD2'
,SRV.SPECODE3 'ÖZEL KOD3'
,SRV.SPECODE4 'ÖZEL KOD4'
,SRV.SPECODE5 'ÖZEL KOD5'
,SRV.VAT 'KDV'
,ISNULL((SELECT 
        EMU.CODE 
		FROM LG_105_CRDACREF CR WITH (NOLOCK)
		INNER JOIN LG_105_EMUHACC EMU WITH (NOLOCK) ON EMU.LOGICALREF=CR.ACCOUNTREF
		WHERE CR.TRCODE=3 AND CR.TYP=1 AND CR.CARDREF=SRV.LOGICALREF
 ),'') 'MUHASEBE HESABI KODU'
 ,ISNULL((SELECT 
        EMU.DEFINITION_ 
		FROM LG_105_CRDACREF CR WITH (NOLOCK)
		INNER JOIN LG_105_EMUHACC EMU WITH (NOLOCK) ON EMU.LOGICALREF=CR.ACCOUNTREF
		WHERE CR.TRCODE=3 AND CR.TYP=1 AND CR.CARDREF=SRV.LOGICALREF
 ),'') 'MUHASEBE HESABI AÇIKLAMASI'


FROM LG_105_SRVCARD SRV WITH (NOLOCK)


--WHERE SRV.CARDTYPE=1 AND SRV.ACTIVE=0

UNION ALL
SELECT 

FIRMA='106_BIZ_KLINIK'

,SRV.CODE 'HIZMET KODU'
,SRV.DEFINITION_ 'HIZMET ADI'
,SRV.SPECODE 'ÖZEL KOD1'
,ISNULL((SELECT SPE.DEFINITION_ FROM LG_106_SPECODES SPE WITH (NOLOCK) WHERE SPE.SPECODE=SRV.SPECODE AND SPE.CODETYPE=1 AND SPE.SPECODETYPE=4),'') 'ÖZEL KOD1 ACIKLAMA'
,SRV.SPECODE2 'ÖZEL KOD2'
,SRV.SPECODE3 'ÖZEL KOD3'
,SRV.SPECODE4 'ÖZEL KOD4'
,SRV.SPECODE5 'ÖZEL KOD5'
,SRV.VAT 'KDV'
,ISNULL((SELECT 
        EMU.CODE 
		FROM LG_106_CRDACREF CR WITH (NOLOCK)
		INNER JOIN LG_106_EMUHACC EMU WITH (NOLOCK) ON EMU.LOGICALREF=CR.ACCOUNTREF
		WHERE CR.TRCODE=3 AND CR.TYP=1 AND CR.CARDREF=SRV.LOGICALREF
 ),'') 'MUHASEBE HESABI KODU'
 ,ISNULL((SELECT 
        EMU.DEFINITION_ 
		FROM LG_106_CRDACREF CR WITH (NOLOCK)
		INNER JOIN LG_106_EMUHACC EMU WITH (NOLOCK) ON EMU.LOGICALREF=CR.ACCOUNTREF
		WHERE CR.TRCODE=3 AND CR.TYP=1 AND CR.CARDREF=SRV.LOGICALREF
 ),'') 'MUHASEBE HESABI AÇIKLAMASI'


FROM LG_106_SRVCARD SRV WITH (NOLOCK)


--WHERE SRV.CARDTYPE=1 AND SRV.ACTIVE=0

GO
