USE [NETLINE_TIGER]
GO

/****** Object:  View [dbo].[AAMG_TÜM_Yevmiye_Defteri]    Script Date: 2/22/2025 6:21:55 PM ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO








ALTER VIEW 
[dbo].[AAMG_TÜM_Yevmiye_Defteri]
AS
select 
'101_TEZ_MEDİKAL' AS Firma,
EMF.JOURNALNO [YEVMİYE MADDO NO], 
EMF.FICHENO [FIS NO],
EML.INVOICENO [FAT.NO],
EMF.DATE_ [TARİH], 
EML.YEAR_ [YIL],
EML.MONTH_ [AY], 
--EML.CROSSCODE [KARŞI HS.KOD.],
--EML.CLDEF [KARŞI HS.ÜNV.],
EMU.CODE [HESAP KODU],

LEFT (EMU.CODE,6) [HESAP K. GRUP1],
LEFT (EMU.CODE,9) [HESAP K. GRUP2],
EML.KEBIRCODE [KEBİR],
LEFT (EML.KEBIRCODE,2) [BİLANÇO KALEMİ],
LEFT (EML.KEBIRCODE,1) [ANA GRUP],
EMU.DEFINITION_ [HESAP ADI], 
EMF.GENEXP1 [FİŞ AÇIKLAMASI], 
EML.LINEEXP [SATRI AÇIKLAMASI],
EML.DEBIT [BORÇ], 
--EMF.SPECODE [FİŞ ÖZELKOD],
EML.CREDIT*-1 [ALACAK],
EML.DEBIT+(EML.CREDIT*-1) [BAKİYE],
EML.TRNET [DÖVİZ T.],
EML.TRCURR [İD TÜR],
CASE WHEN EML.TRCURR = 1 THEN 'USD' WHEN EML.TRCURR = 0 THEN 'TL' WHEN EML.TRCURR = 20 THEN 'EUR' END [İD],
EMF.TOTALACTIVE [FİŞ TOPLAMI],
CASE WHEN EMF.TRCODE = 1 THEN 'AçİlİŞ FiŞi' 
	 WHEN EMF.TRCODE = 2 THEN 'Tahsil FiŞi'
	 WHEN EMF.TRCODE = 3 THEN 'Tediye FiŞi'
	 WHEN EMF.TRCODE = 4 THEN 'Mahsup FiŞi'
	 WHEN EMF.TRCODE = 5 THEN 'Özel FiŞ'
	 WHEN EMF.TRCODE = 6 THEN 'Kur Farkİ FiŞi'
	 WHEN EMF.TRCODE = 7 THEN 'KapanİŞ FiŞi'
	 
END [FİŞ TÜRÜ]

FROM 
LG_101_01_EMFICHE EMF WITH (NOLOCK)
INNER JOIN LG_101_01_EMFLINE EML WITH (NOLOCK) ON EMF.LOGICALREF=EML.ACCFICHEREF
INNER JOIN LG_101_EMUHACC EMU WITH (NOLOCK) ON EML.ACCOUNTREF=EMU.LOGICALREF
WHERE  EMF.CANCELLED=0  AND EML.YEAR_='2024'  -- AND EML.KEBIRCODE='102' --OR EML.KEBIRCODE= '105'  --AND EML.YEAR_='2021' 

---SELECT * FROM LG_105_01_EMFLINE WHERE SPECODE='KapanİŞ'
UNION ALL
select 
'105_TEZ_FILO' AS Firma,
EMF.JOURNALNO [YEVMİYE MADDO NO], 
EMF.FICHENO [FIS NO],
EML.INVOICENO [FAT.NO],
EMF.DATE_ [TARİH], 
EML.YEAR_ [YIL],
EML.MONTH_ [AY], 
--EML.CROSSCODE [KARŞI HS.KOD.],
--EML.CLDEF [KARŞI HS.ÜNV.],
EMU.CODE [HESAP KODU],

LEFT (EMU.CODE,6) [HESAP K. GRUP1],
LEFT (EMU.CODE,9) [HESAP K. GRUP2],
EML.KEBIRCODE [KEBİR],
LEFT (EML.KEBIRCODE,2) [BİLANÇO KALEMİ],
LEFT (EML.KEBIRCODE,1) [ANA GRUP],
EMU.DEFINITION_ [HESAP ADI], 
EMF.GENEXP1 [FİŞ AÇIKLAMASI], 
EML.LINEEXP [SATRI AÇIKLAMASI],
EML.DEBIT [BORÇ], 
--EMF.SPECODE [FİŞ ÖZELKOD],
EML.CREDIT*-1 [ALACAK],
EML.DEBIT+(EML.CREDIT*-1) [BAKİYE],
EML.TRNET [DÖVİZ T.],
EML.TRCURR [İD TÜR],
CASE WHEN EML.TRCURR = 1 THEN 'USD' WHEN EML.TRCURR = 0 THEN 'TL' WHEN EML.TRCURR = 20 THEN 'EUR' END [İD],
EMF.TOTALACTIVE [FİŞ TOPLAMI],
CASE WHEN EMF.TRCODE = 1 THEN 'AçİlİŞ FiŞi' 
	 WHEN EMF.TRCODE = 2 THEN 'Tahsil FiŞi'
	 WHEN EMF.TRCODE = 3 THEN 'Tediye FiŞi'
	 WHEN EMF.TRCODE = 4 THEN 'Mahsup FiŞi'
	 WHEN EMF.TRCODE = 5 THEN 'Özel FiŞ'
	 WHEN EMF.TRCODE = 6 THEN 'Kur Farkİ FiŞi'
	 WHEN EMF.TRCODE = 7 THEN 'KapanİŞ FiŞi'
	 
END [FİŞ TÜRÜ]

FROM 
LG_105_01_EMFICHE EMF WITH (NOLOCK)
INNER JOIN LG_105_01_EMFLINE EML WITH (NOLOCK) ON EMF.LOGICALREF=EML.ACCFICHEREF
INNER JOIN LG_105_EMUHACC EMU WITH (NOLOCK) ON EML.ACCOUNTREF=EMU.LOGICALREF
WHERE  EMF.CANCELLED=0  AND EML.YEAR_='2024'  -- AND EML.KEBIRCODE='102' --OR EML.KEBIRCODE= '105'  --AND EML.YEAR_='2021' 

---SELECT * FROM LG_105_01_EMFLINE WHERE SPECODE='KapanİŞ'


UNION ALL

select 
'106_BIZ_KLINIK' AS Firma,
EMF.JOURNALNO [YEVMİYE MADDO NO], 
EMF.FICHENO [FIS NO],
EML.INVOICENO [FAT.NO],
EMF.DATE_ [TARİH], 
EML.YEAR_ [YIL],
EML.MONTH_ [AY], 
--EML.CROSSCODE [KARŞI HS.KOD.],
--EML.CLDEF [KARŞI HS.ÜNV.],
EMU.CODE [HESAP KODU],

LEFT (EMU.CODE,6) [HESAP K. GRUP1],
LEFT (EMU.CODE,9) [HESAP K. GRUP2],
EML.KEBIRCODE [KEBİR],
LEFT (EML.KEBIRCODE,2) [BİLANÇO KALEMİ],
LEFT (EML.KEBIRCODE,1) [ANA GRUP],
EMU.DEFINITION_ [HESAP ADI], 
EMF.GENEXP1 [FİŞ AÇIKLAMASI], 
EML.LINEEXP [SATRI AÇIKLAMASI],
EML.DEBIT [BORÇ], 
--EMF.SPECODE [FİŞ ÖZELKOD],
EML.CREDIT*-1 [ALACAK],
EML.DEBIT+(EML.CREDIT*-1) [BAKİYE],
EML.TRNET [DÖVİZ T.],
EML.TRCURR [İD TÜR],
CASE WHEN EML.TRCURR = 1 THEN 'USD' WHEN EML.TRCURR = 0 THEN 'TL' WHEN EML.TRCURR = 20 THEN 'EUR' END [İD],
EMF.TOTALACTIVE [FİŞ TOPLAMI],
CASE WHEN EMF.TRCODE = 1 THEN 'AçİlİŞ FiŞi' 
	 WHEN EMF.TRCODE = 2 THEN 'Tahsil FiŞi'
	 WHEN EMF.TRCODE = 3 THEN 'Tediye FiŞi'
	 WHEN EMF.TRCODE = 4 THEN 'Mahsup FiŞi'
	 WHEN EMF.TRCODE = 5 THEN 'Özel FiŞ'
	 WHEN EMF.TRCODE = 6 THEN 'Kur Farkİ FiŞi'
	 WHEN EMF.TRCODE = 7 THEN 'KapanİŞ FiŞi'
	 
END [FİŞ TÜRÜ]
FROM 
LG_106_01_EMFICHE EMF WITH (NOLOCK)
INNER JOIN LG_106_01_EMFLINE EML WITH (NOLOCK) ON EMF.LOGICALREF=EML.ACCFICHEREF
INNER JOIN LG_106_EMUHACC EMU WITH (NOLOCK) ON EML.ACCOUNTREF=EMU.LOGICALREF
WHERE  EMF.CANCELLED=0  AND EML.YEAR_='2024' -- AND EML.KEBIRCODE='102' --OR EML.KEBIRCODE= '106'  --AND EML.YEAR_='2021' 

---SELECT * FROM LG_106_01_EMFLINE WHERE SPECODE='KapanİŞ'



UNION ALL

select 
'107_TEZMED_HOL' AS Firma,
EMF.JOURNALNO [YEVMİYE MADDO NO], 
EMF.FICHENO [FIS NO],
EML.INVOICENO [FAT.NO],
EMF.DATE_ [TARİH], 
EML.YEAR_ [YIL],
EML.MONTH_ [AY], 
--EML.CROSSCODE [KARŞI HS.KOD.],
--EML.CLDEF [KARŞI HS.ÜNV.],
EMU.CODE [HESAP KODU],

LEFT (EMU.CODE,6) [HESAP K. GRUP1],
LEFT (EMU.CODE,9) [HESAP K. GRUP2],
EML.KEBIRCODE [KEBİR],
LEFT (EML.KEBIRCODE,2) [BİLANÇO KALEMİ],
LEFT (EML.KEBIRCODE,1) [ANA GRUP],
EMU.DEFINITION_ [HESAP ADI], 
EMF.GENEXP1 [FİŞ AÇIKLAMASI], 
EML.LINEEXP [SATRI AÇIKLAMASI],
EML.DEBIT [BORÇ], 
--EMF.SPECODE [FİŞ ÖZELKOD],
EML.CREDIT*-1 [ALACAK],
EML.DEBIT+(EML.CREDIT*-1) [BAKİYE],
EML.TRNET [DÖVİZ T.],
EML.TRCURR [İD TÜR],
CASE WHEN EML.TRCURR = 1 THEN 'USD' WHEN EML.TRCURR = 0 THEN 'TL' WHEN EML.TRCURR = 20 THEN 'EUR' END [İD],
EMF.TOTALACTIVE [FİŞ TOPLAMI],
CASE WHEN EMF.TRCODE = 1 THEN 'AçİlİŞ FiŞi' 
	 WHEN EMF.TRCODE = 2 THEN 'Tahsil FiŞi'
	 WHEN EMF.TRCODE = 3 THEN 'Tediye FiŞi'
	 WHEN EMF.TRCODE = 4 THEN 'Mahsup FiŞi'
	 WHEN EMF.TRCODE = 5 THEN 'Özel FiŞ'
	 WHEN EMF.TRCODE = 6 THEN 'Kur Farkİ FiŞi'
	 WHEN EMF.TRCODE = 7 THEN 'KapanİŞ FiŞi'
	 
END [FİŞ TÜRÜ]
FROM 
LG_107_01_EMFICHE EMF WITH (NOLOCK)
INNER JOIN LG_107_01_EMFLINE EML WITH (NOLOCK) ON EMF.LOGICALREF=EML.ACCFICHEREF
INNER JOIN LG_107_EMUHACC EMU WITH (NOLOCK) ON EML.ACCOUNTREF=EMU.LOGICALREF
WHERE  EMF.CANCELLED=0  AND EML.YEAR_='2024' -- AND EML.KEBIRCODE='102' --OR EML.KEBIRCODE= '107'  --AND EML.YEAR_='2021' 

---SELECT * FROM LG_107_01_EMFLINE WHERE SPECODE='KapanİŞ'




UNION ALL

select 
'108_TEZ_INOV' AS Firma,
EMF.JOURNALNO [YEVMİYE MADDO NO], 
EMF.FICHENO [FIS NO],
EML.INVOICENO [FAT.NO],
EMF.DATE_ [TARİH], 
EML.YEAR_ [YIL],
EML.MONTH_ [AY], 
--EML.CROSSCODE [KARŞI HS.KOD.],
--EML.CLDEF [KARŞI HS.ÜNV.],
EMU.CODE [HESAP KODU],

LEFT (EMU.CODE,6) [HESAP K. GRUP1],
LEFT (EMU.CODE,9) [HESAP K. GRUP2],
EML.KEBIRCODE [KEBİR],
LEFT (EML.KEBIRCODE,2) [BİLANÇO KALEMİ],
LEFT (EML.KEBIRCODE,1) [ANA GRUP],
EMU.DEFINITION_ [HESAP ADI], 
EMF.GENEXP1 [FİŞ AÇIKLAMASI], 
EML.LINEEXP [SATRI AÇIKLAMASI],
EML.DEBIT [BORÇ], 
--EMF.SPECODE [FİŞ ÖZELKOD],
EML.CREDIT*-1 [ALACAK],
EML.DEBIT+(EML.CREDIT*-1) [BAKİYE],
EML.TRNET [DÖVİZ T.],
EML.TRCURR [İD TÜR],
CASE WHEN EML.TRCURR = 1 THEN 'USD' WHEN EML.TRCURR = 0 THEN 'TL' WHEN EML.TRCURR = 20 THEN 'EUR' END [İD],
EMF.TOTALACTIVE [FİŞ TOPLAMI],
CASE WHEN EMF.TRCODE = 1 THEN 'AçİlİŞ FiŞi' 
	 WHEN EMF.TRCODE = 2 THEN 'Tahsil FiŞi'
	 WHEN EMF.TRCODE = 3 THEN 'Tediye FiŞi'
	 WHEN EMF.TRCODE = 4 THEN 'Mahsup FiŞi'
	 WHEN EMF.TRCODE = 5 THEN 'Özel FiŞ'
	 WHEN EMF.TRCODE = 6 THEN 'Kur Farkİ FiŞi'
	 WHEN EMF.TRCODE = 7 THEN 'KapanİŞ FiŞi'
	 
END [FİŞ TÜRÜ]
FROM 
LG_108_01_EMFICHE EMF WITH (NOLOCK)
INNER JOIN LG_108_01_EMFLINE EML WITH (NOLOCK) ON EMF.LOGICALREF=EML.ACCFICHEREF
INNER JOIN LG_108_EMUHACC EMU WITH (NOLOCK) ON EML.ACCOUNTREF=EMU.LOGICALREF
WHERE  EMF.CANCELLED=0  AND EML.YEAR_='2024' -- AND EML.KEBIRCODE='102' --OR EML.KEBIRCODE= '108'  --AND EML.YEAR_='2021' 

---SELECT * FROM LG_108_01_EMFLINE WHERE SPECODE='KapanİŞ'














GO


